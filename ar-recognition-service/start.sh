#!/bin/bash

# ุณูุฑุจุช ุชุดุบูู ุฎุฏูุฉ ุงูุชุนุฑู ุนูู ุงูุฃูุงูู ุจู OpenCV
# Riyadh AR Recognition Service Startup Script

echo "๐ ุจุฏุก ุชุดุบูู ุฎุฏูุฉ ุงูุชุนุฑู ุนูู ุงูุฃูุงูู..."
echo "========================================"

# ุงูุชุญูู ูู ูุฌูุฏ Python
if ! command -v python3 &> /dev/null; then
    echo "โ Python3 ุบูุฑ ูุซุจุช. ูุฑุฌู ุชุซุจูุชู ุฃููุงู."
    exit 1
fi

# ุงูุงูุชูุงู ููุฌูุฏ ุงูุฎุฏูุฉ
cd "$(dirname "$0")"

# ุงูุชุญูู ูู ูุฌูุฏ virtual environment
if [ ! -d "venv" ]; then
    echo "๐ฆ ุฅูุดุงุก ุจูุฆุฉ Python ุงูุชุฑุงุถูุฉ..."
    python3 -m venv venv
fi

# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ
source venv/bin/activate

# ุชุซุจูุช ุงููุชุทูุจุงุช
echo "๐ฅ ุชุซุจูุช ุงููุชุทูุจุงุช..."
pip install -r requirements.txt --quiet

# ุฅูุดุงุก ูุฌูุฏ ุงูุตูุฑ ุงููุฑุฌุนูุฉ
mkdir -p reference_images

# ุชุดุบูู ุงูุฎุงุฏู
echo ""
echo "โ ุชู ุชุฌููุฒ ุงูุฎุฏูุฉ"
echo "๐ ุงูุฎุฏูุฉ ุชุนูู ุนูู: http://localhost:5001"
echo "๐ ุนุฏุฏ ุงูุฃูุงูู ุงููุณุฌูุฉ: 10"
echo ""
echo "ููุฅููุงู ุงุถุบุท Ctrl+C"
echo "========================================"

python3 server.py
